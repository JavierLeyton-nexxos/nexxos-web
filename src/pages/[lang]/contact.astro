---
import { getLangFromUrl, useTranslations } from '../../i18n/utils'
import Layout from '../../layouts/Layout.astro'
import Navbar from '../../components/Navbar.astro'
import ActionFooter from '../../components/ActionFooter.astro'

export function getStaticPaths() {
	return [{ params: { lang: 'en' } }, { params: { lang: 'pt-br' } }]
}

const lang = getLangFromUrl(Astro.url)
const t = useTranslations(lang)
---

<Layout title={`Contact | nexxos AI Hub`}>
	<Navbar />

	<main class='min-h-screen pt-32 pb-24 px-6 bg-brand-bone'>
		<div class='max-w-4xl mx-auto'>
			<!-- Header -->
			<div class='mb-12 text-center'>
				<h1
					class='text-4xl md:text-6xl font-bold uppercase tracking-tighter mb-6 text-brand-black'
				>
					{t('contact.title')}
				</h1>
				<p class='text-brand-gray text-lg max-w-2xl mx-auto'>
					{t('contact.desc')}
				</p>
			</div>

			<!-- Form Container -->
			<div
				class='bg-white p-8 md:p-12 rounded-bento shadow-xl border border-brand-black/5'
			>
				<form class='space-y-8' id='form'>
					<input
						type='hidden'
						name='access_key'
						value='7aadbcab-414b-4c34-8b1b-89a79200e1a9'
					/>
					<div id='result' class='text-center text-sm font-bold'></div>

					<div class='grid grid-cols-1 md:grid-cols-2 gap-8'>
						<div class='space-y-2'>
							<label
								class='text-xs font-bold uppercase tracking-widest text-brand-gray'
							>
								{t('contact.form.name')}
							</label>
							<input
								type='text'
								name='name'
								class='w-full bg-brand-bone/50 border-b-2 border-brand-black/10 p-3 focus:outline-none focus:border-brand-blue transition-colors rounded-t-lg'
								placeholder={t('contact.form.name.placeholder')}
								required
							/>
						</div>
						<div class='space-y-2'>
							<label
								class='text-xs font-bold uppercase tracking-widest text-brand-gray'
							>
								{t('contact.form.company')}
							</label>
							<input
								type='text'
								name='company'
								class='w-full bg-brand-bone/50 border-b-2 border-brand-black/10 p-3 focus:outline-none focus:border-brand-blue transition-colors rounded-t-lg'
								placeholder={t('contact.form.company.placeholder')}
								required
							/>
						</div>
					</div>

					<div class='space-y-2'>
						<label
							class='text-xs font-bold uppercase tracking-widest text-brand-gray'
							>{t('contact.form.email')}</label
						>
						<input
							type='email'
							name='email'
							class='w-full bg-brand-bone/50 border-b-2 border-brand-black/10 p-3 focus:outline-none focus:border-brand-blue transition-colors rounded-t-lg'
							placeholder={t('contact.form.email.placeholder')}
							required
						/>
					</div>
					<div class='space-y-2'>
						<label
							class='text-xs font-bold uppercase tracking-widest text-brand-gray'
							>{t('contact.form.country')}</label
						>
						<input
							type='text'
							name='country'
							class='w-full bg-brand-bone/50 border-b-2 border-brand-black/10 p-3 focus:outline-none focus:border-brand-blue transition-colors rounded-t-lg'
							placeholder={t('contact.form.country.placeholder')}
							required
						/>
					</div>
					<div class='space-y-2'>
						<label
							class='text-xs font-bold uppercase tracking-widest text-brand-gray'
						>
							{t('contact.form.interest')}
						</label>
						<select
							name='interest'
							class='w-full bg-brand-bone/50 border-b-2 border-brand-black/10 p-3 focus:outline-none focus:border-brand-blue transition-colors rounded-t-lg'
						>
							<option>{t('contact.form.interest.gpu')}</option>
							<option>{t('contact.form.interest.invest')}</option>
							<option>{t('contact.form.interest.partner')}</option>
							<option>{t('contact.form.interest.other')}</option>
						</select>
					</div>

					<div class='space-y-2'>
						<label
							class='text-xs font-bold uppercase tracking-widest text-brand-gray'
						>
							{t('contact.form.message')}
						</label>
						<textarea
							name='message'
							rows='4'
							class='w-full bg-brand-bone/50 border-b-2 border-brand-black/10 p-3 focus:outline-none focus:border-brand-blue transition-colors rounded-t-lg'
							required></textarea>
					</div>

					<button
						type='submit'
						class='w-full bg-brand-black text-white py-4 rounded-full font-bold uppercase tracking-widest hover:bg-brand-neon hover:text-brand-black transition-colors'
					>
						{t('contact.form.submit')}
					</button>
				</form>
			</div>
		</div>
	</main>

	<ActionFooter />
</Layout>

<script is:inline>
	const form = document.getElementById('form')
	const result = document.getElementById('result')

	form.addEventListener('submit', function (e) {
		const formData = new FormData(form)
		e.preventDefault()

		const object = Object.fromEntries(formData)
		const json = JSON.stringify(object)

		result.innerHTML = 'Please wait...'

		fetch('https://api.web3forms.com/submit', {
			method: 'POST',
			headers: {
				'Content-Type': 'application/json',
				Accept: 'application/json',
			},
			body: json,
		})
			.then(async (response) => {
				let json = await response.json()
				if (response.status == 200) {
					result.innerHTML = json.message
				} else {
					console.log(response)
					result.innerHTML = json.message
				}
			})
			.catch((error) => {
				console.log(error)
				result.innerHTML = 'Something went wrong!'
			})
			.then(function () {
				form.reset()
				setTimeout(() => {
					result.style.display = 'none'
				}, 3000)
			})
	})
</script>
